function hexToBytes(t){for(var i=[],e=0;e<t.length;e+=2)i.push(parseInt(t.substr(e,2),16));return i}function bytesToHex(t){for(var i=[],e=0;e<t.length;e++)i.push((t[e]>>>4).toString(16)),i.push((15&t[e]).toString(16));return i.join("")}
if(
function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=window.Crypto={},e=i.util={rotl:function(t,i){return t<<i|t>>>32-i},rotr:function(t,i){return t<<32-i|t>>>i},endian:function(t){if(t.constructor==Number)return 16711935&e.rotl(t,8)|4278255360&e.rotl(t,24);for(var i=0;i<t.length;i++)t[i]=e.endian(t[i]);return t},randomBytes:function(t){for(var i=[];t>0;t--)i.push(Math.floor(256*Math.random()));return i},bytesToWords:function(t){for(var i=[],e=0,r=0;e<t.length;e++,r+=8)i[r>>>5]|=t[e]<<24-r%32;return i},wordsToBytes:function(t){for(var i=[],e=0;e<32*t.length;e+=8)i.push(t[e>>>5]>>>24-e%32&255);return i},bytesToHex:function(t){for(var i=[],e=0;e<t.length;e++)i.push((t[e]>>>4).toString(16)),i.push((15&t[e]).toString(16));return i.join("")},hexToBytes:function(t){for(var i=[],e=0;e<t.length;e+=2)i.push(parseInt(t.substr(e,2),16));return i},bytesToBase64:function(i){if("function"==typeof btoa)return btoa(n.bytesToString(i));for(var e=[],r=0;r<i.length;r+=3)for(var o=i[r]<<16|i[r+1]<<8|i[r+2],s=0;s<4;s++)8*r+6*s<=8*i.length?e.push(t.charAt(o>>>6*(3-s)&63)):e.push("=");return e.join("")},base64ToBytes:function(i){if("function"==typeof atob)return n.stringToBytes(atob(i));i=i.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,o=0;r<i.length;o=++r%4)0!=o&&e.push((t.indexOf(i.charAt(r-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(i.charAt(r))>>>6-2*o);return e}};i.mode={};var r=i.charenc={},n=(r.UTF8={stringToBytes:function(t){return n.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bytesToString(t)))}},r.Binary={stringToBytes:function(t){for(var i=[],e=0;e<t.length;e++)i.push(t.charCodeAt(e));return i},bytesToString:function(t){for(var i=[],e=0;e<t.length;e++)i.push(String.fromCharCode(t[e]));return i.join("")}})}(),
function(){var t=Crypto,i=t.util,e=t.charenc,r=e.UTF8,n=e.Binary,o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=t.SHA256=function(t,e){var r=i.wordsToBytes(s._sha256(t));return e&&e.asBytes?r:e&&e.asString?n.bytesToString(r):i.bytesToHex(r)};s._sha256=function(t){t.constructor==String&&(t=r.stringToBytes(t));var e,n,s,u,h,a,p,f,c,l=i.bytesToWords(t),g=8*t.length,y=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],m=[];l[g>>5]|=128<<24-g%32,l[15+(g+64>>9<<4)]=g;for(var d=0;d<l.length;d+=16){e=y[0],n=y[1],s=y[2],u=y[3],h=y[4],a=y[5],p=y[6],f=y[7];for(var v=0;v<64;v++){if(v<16)m[v]=l[v+d];else{var B=m[v-15],T=m[v-2],F=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,b=(T<<15|T>>>17)^(T<<13|T>>>19)^T>>>10;m[v]=F+(m[v-7]>>>0)+b+(m[v-16]>>>0)}var I=e&n^e&s^n&s,w=(e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22);c=(f>>>0)+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&a^~h&p)+o[v]+(m[v]>>>0),f=p,p=a,a=h,h=u+c,u=s,s=n,n=e,e=c+(w+I)}y[0]+=e,y[1]+=n,y[2]+=s,y[3]+=u,y[4]+=h,y[5]+=a,y[6]+=p,y[7]+=f}return y},s._blocksize=16}(),
function(){var t=Crypto,i=t.util,e=t.charenc,r=e.UTF8,n=e.Binary;i.bytesToLWords=function(t){for(var i=Array(t.length>>2),e=0;e<i.length;e++)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t[e/8])<<e%32;return i},i.lWordsToBytes=function(t){for(var i=[],e=0;e<32*t.length;e+=8)i.push(t[e>>5]>>>e%32&255);return i};var o=t.RIPEMD160=function(t,e){var r=i.lWordsToBytes(o._rmd160(t));return e&&e.asBytes?r:e&&e.asString?n.bytesToString(r):i.bytesToHex(r)};function s(t,i,e,r){return 0<=t&&t<=15?i^e^r:16<=t&&t<=31?i&e|~i&r:32<=t&&t<=47?(i|~e)^r:48<=t&&t<=63?i&r|e&~r:64<=t&&t<=79?i^(e|~r):"rmd160_f: j out of range"}function u(t){return 0<=t&&t<=15?0:16<=t&&t<=31?1518500249:32<=t&&t<=47?1859775393:48<=t&&t<=63?2400959708:64<=t&&t<=79?2840853838:"rmd160_K1: j out of range"}function h(t){return 0<=t&&t<=15?1352829926:16<=t&&t<=31?1548603684:32<=t&&t<=47?1836072691:48<=t&&t<=63?2053994217:64<=t&&t<=79?0:"rmd160_K2: j out of range"}o._rmd160=function(t){t.constructor==String&&(t=r.stringToBytes(t));var e=i.bytesToLWords(t),n=8*t.length;e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;for(var o=1732584193,y=4023233417,m=2562383102,d=271733878,v=3285377520,B=0;B<e.length;B+=16){for(var T,F=o,b=y,I=m,w=d,S=v,E=o,D=y,A=m,q=d,C=v,x=0;x<=79;++x)T=l(g(T=l(T=l(T=l(F,s(x,b,I,w)),e[B+a[x]]),u(x)),f[x]),S),F=S,S=w,w=g(I,10),I=b,b=T,T=l(g(T=l(T=l(T=l(E,s(79-x,D,A,q)),e[B+p[x]]),h(x)),c[x]),C),E=C,C=q,q=g(A,10),A=D,D=T;T=l(y,l(I,q)),y=l(m,l(w,C)),m=l(d,l(S,E)),d=l(v,l(F,D)),v=l(o,l(b,A)),o=T}return[o,y,m,d,v]};var a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],c=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function l(t,i){var e=(65535&t)+(65535&i);return(t>>16)+(i>>16)+(e>>16)<<16|65535&e}function g(t,i){return t<<i|t>>>32-i}}(),
function(){var t=window.EllipticCurve=function(){};t.FieldElementFp=function(t,i){this.x=i,this.q=t},t.FieldElementFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},t.FieldElementFp.prototype.toBigInteger=function(){return this.x},t.FieldElementFp.prototype.negate=function(){return new t.FieldElementFp(this.q,this.x.negate().mod(this.q))},t.FieldElementFp.prototype.add=function(i){return new t.FieldElementFp(this.q,this.x.add(i.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.subtract=function(i){return new t.FieldElementFp(this.q,this.x.subtract(i.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.multiply=function(i){return new t.FieldElementFp(this.q,this.x.multiply(i.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.square=function(){return new t.FieldElementFp(this.q,this.x.square().mod(this.q))},t.FieldElementFp.prototype.divide=function(i){return new t.FieldElementFp(this.q,this.x.multiply(i.toBigInteger().modInverse(this.q)).mod(this.q))},t.FieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},t.PointFp=function(t,i,e,r){this.curve=t,this.x=i,this.y=e,this.z=null==r?BigInteger.ONE:r,this.zinv=null},t.PointFp.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},t.PointFp.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},t.PointFp.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO))},t.PointFp.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)},t.PointFp.prototype.negate=function(){return new t.PointFp(this.curve,this.x,this.y.negate(),this.z)},t.PointFp.prototype.add=function(i){if(this.isInfinity())return i;if(i.isInfinity())return this;var e=i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q),r=i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(r))return BigInteger.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new BigInteger("3"),o=this.x.toBigInteger(),s=this.y.toBigInteger(),u=(i.x.toBigInteger(),i.y.toBigInteger(),r.square()),h=u.multiply(r),a=o.multiply(u),p=e.square().multiply(this.z),f=p.subtract(a.shiftLeft(1)).multiply(i.z).subtract(h).multiply(r).mod(this.curve.q),c=a.multiply(n).multiply(e).subtract(s.multiply(h)).subtract(p.multiply(e)).multiply(i.z).add(e.multiply(h)).mod(this.curve.q),l=h.multiply(this.z).multiply(i.z).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(c),l)},t.PointFp.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var i=new BigInteger("3"),e=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),o=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),u=e.square().multiply(i);BigInteger.ZERO.equals(s)||(u=u.add(this.z.square().multiply(s)));var h=(u=u.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(n).mod(this.curve.q),a=u.multiply(i).multiply(e).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(u.square().multiply(u)).mod(this.curve.q),p=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(a),p)},t.PointFp.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var i,e=t,r=e.multiply(new BigInteger("3")),n=this.negate(),o=this;for(i=r.bitLength()-2;i>0;--i){o=o.twice();var s=r.testBit(i);s!=e.testBit(i)&&(o=o.add(s?this:n))}return o},t.PointFp.prototype.multiplyTwo=function(t,i,e){var r;r=t.bitLength()>e.bitLength()?t.bitLength()-1:e.bitLength()-1;for(var n=this.curve.getInfinity(),o=this.add(i);r>=0;)n=n.twice(),t.testBit(r)?n=e.testBit(r)?n.add(o):n.add(this):e.testBit(r)&&(n=n.add(i)),--r;return n},t.PointFp.prototype.getEncoded=function(i){var e=this.getX().toBigInteger(),r=this.getY().toBigInteger(),n=t.integerToBytes(e,32);return i?r.isEven()?n.unshift(2):n.unshift(3):(n.unshift(4),n=n.concat(t.integerToBytes(r,32))),n},t.PointFp.decodeFrom=function(i,e){e[0];var r=e.length-1,n=e.slice(1,1+r/2),o=e.slice(1+r/2,1+r);n.unshift(0),o.unshift(0);var s=new BigInteger(n),u=new BigInteger(o);return new t.PointFp(i,i.fromBigInteger(s),i.fromBigInteger(u))},t.PointFp.prototype.add2D=function(i){if(this.isInfinity())return i;if(i.isInfinity())return this;if(this.x.equals(i.x))return this.y.equals(i.y)?this.twice():this.curve.getInfinity();var e=i.x.subtract(this.x),r=i.y.subtract(this.y).divide(e),n=r.square().subtract(this.x).subtract(i.x),o=r.multiply(this.x.subtract(n)).subtract(this.y);return new t.PointFp(this.curve,n,o)},t.PointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var i=this.curve.fromBigInteger(BigInteger.valueOf(2)),e=this.curve.fromBigInteger(BigInteger.valueOf(3)),r=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(i)),n=r.square().subtract(this.x.multiply(i)),o=r.multiply(this.x.subtract(n)).subtract(this.y);return new t.PointFp(this.curve,n,o)},t.PointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var i,e=t,r=e.multiply(new BigInteger("3")),n=this.negate(),o=this;for(i=r.bitLength()-2;i>0;--i){o=o.twice();var s=r.testBit(i);s!=e.testBit(i)&&(o=o.add2D(s?this:n))}return o},t.PointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),i=this.getY().toBigInteger(),e=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),n=this.curve.getQ(),o=i.multiply(i).mod(n),s=t.multiply(t).multiply(t).add(e.multiply(t)).add(r).mod(n);return o.equals(s)},t.PointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var i=this.getX().toBigInteger(),e=this.getY().toBigInteger();if(i.compareTo(BigInteger.ONE)<0||i.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(e.compareTo(BigInteger.ONE)<0||e.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},t.CurveFp=function(i,e,r){this.q=i,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new t.PointFp(this,null,null)},t.CurveFp.prototype.getQ=function(){return this.q},t.CurveFp.prototype.getA=function(){return this.a},t.CurveFp.prototype.getB=function(){return this.b},t.CurveFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},t.CurveFp.prototype.getInfinity=function(){return this.infinity},t.CurveFp.prototype.fromBigInteger=function(i){return new t.FieldElementFp(this.q,i)},t.CurveFp.prototype.decodePointHex=function(i){switch(parseInt(i.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(i.length-2)/2,r=i.substr(2,e),n=i.substr(e+2,e);return new t.PointFp(this,this.fromBigInteger(new BigInteger(r,16)),this.fromBigInteger(new BigInteger(n,16)));default:return null}},t.fromHex=function(t){return new BigInteger(t,16)},t.integerToBytes=function(t,i){var e=t.toByteArrayUnsigned();if(i<e.length)e=e.slice(e.length-i);else for(;i>e.length;)e.unshift(0);return e},t.X9Parameters=function(t,i,e,r){this.curve=t,this.g=i,this.n=e,this.h=r},t.X9Parameters.prototype.getCurve=function(){return this.curve},t.X9Parameters.prototype.getG=function(){return this.g},t.X9Parameters.prototype.getN=function(){return this.n},t.X9Parameters.prototype.getH=function(){return this.h},t.secNamedCurves={secp256k1:function(){var i=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),e=BigInteger.ZERO,r=t.fromHex("7"),n=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),o=BigInteger.ONE,s=new t.CurveFp(i,e,r),u=s.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new t.X9Parameters(s,u,n,o)}},t.getSECCurveByName=function(i){return null==t.secNamedCurves[i]?null:t.secNamedCurves[i]()}}(),
function(){var t,i=window.BigInteger=function(t,i,e){null!=t&&("number"==typeof t?this.fromNumber(t,i,e):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))};function e(){return new i(null)}"Microsoft Internet Explorer"==navigator.appName?(i.prototype.am=function(t,i,e,r,n,o){for(var s=32767&i,u=i>>15;--o>=0;){var h=32767&this[t],a=this[t++]>>15,p=u*h+a*s;n=((h=s*h+((32767&p)<<15)+e[r]+(1073741823&n))>>>30)+(p>>>15)+u*a+(n>>>30),e[r++]=1073741823&h}return n},t=30):"Netscape"!=navigator.appName?(i.prototype.am=function(t,i,e,r,n,o){for(;--o>=0;){var s=i*this[t++]+e[r]+n;n=Math.floor(s/67108864),e[r++]=67108863&s}return n},t=26):(i.prototype.am=function(t,i,e,r,n,o){for(var s=16383&i,u=i>>14;--o>=0;){var h=16383&this[t],a=this[t++]>>14,p=u*h+a*s;n=((h=s*h+((16383&p)<<14)+e[r]+n)>>28)+(p>>14)+u*a,e[r++]=268435455&h}return n},t=28),i.prototype.DB=t,i.prototype.DM=(1<<t)-1,i.prototype.DV=1<<t;i.prototype.FV=Math.pow(2,52),i.prototype.F1=52-t,i.prototype.F2=2*t-52;var r,n,o="0123456789abcdefghijklmnopqrstuvwxyz",s=new Array;for(r="0".charCodeAt(0),n=0;n<=9;++n)s[r++]=n;for(r="a".charCodeAt(0),n=10;n<36;++n)s[r++]=n;for(r="A".charCodeAt(0),n=10;n<36;++n)s[r++]=n;function u(t){return o.charAt(t)}function h(t,i){var e=s[t.charCodeAt(i)];return null==e?-1:e}function a(t){var i=e();return i.fromInt(t),i}function p(t){var i,e=1;return 0!=(i=t>>>16)&&(t=i,e+=16),0!=(i=t>>8)&&(t=i,e+=8),0!=(i=t>>4)&&(t=i,e+=4),0!=(i=t>>2)&&(t=i,e+=2),0!=(i=t>>1)&&(t=i,e+=1),e}function f(t){if(0==t)return-1;var i=0;return 0==(65535&t)&&(t>>=16,i+=16),0==(255&t)&&(t>>=8,i+=8),0==(15&t)&&(t>>=4,i+=4),0==(3&t)&&(t>>=2,i+=2),0==(1&t)&&++i,i}function c(t){for(var i=0;0!=t;)t&=t-1,++i;return i}i.prototype.copyTo=function(t){for(var i=this.t-1;i>=0;--i)t[i]=this[i];t.t=this.t,t.s=this.s},i.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0},i.prototype.fromString=function(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var u=8==r?255&t[n]:h(t,n);u<0?"-"==t.charAt(n)&&(o=!0):(o=!1,0==s?this[this.t++]=u:s+r>this.DB?(this[this.t-1]|=(u&(1<<this.DB-s)-1)<<s,this[this.t++]=u>>this.DB-s):this[this.t-1]|=u<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&i.ZERO.subTo(this,this)},i.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},i.prototype.dlShiftTo=function(t,i){var e;for(e=this.t-1;e>=0;--e)i[e+t]=this[e];for(e=t-1;e>=0;--e)i[e]=0;i.t=this.t+t,i.s=this.s},i.prototype.drShiftTo=function(t,i){for(var e=t;e<this.t;++e)i[e-t]=this[e];i.t=Math.max(this.t-t,0),i.s=this.s},i.prototype.lShiftTo=function(t,i){var e,r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),u=this.s<<r&this.DM;for(e=this.t-1;e>=0;--e)i[e+s+1]=this[e]>>n|u,u=(this[e]&o)<<r;for(e=s-1;e>=0;--e)i[e]=0;i[s]=u,i.t=this.t+s+1,i.s=this.s,i.clamp()},i.prototype.rShiftTo=function(t,i){i.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)i.t=0;else{var r=t%this.DB,n=this.DB-r,o=(1<<r)-1;i[0]=this[e]>>r;for(var s=e+1;s<this.t;++s)i[s-e-1]|=(this[s]&o)<<n,i[s-e]=this[s]>>r;r>0&&(i[this.t-e-1]|=(this.s&o)<<n),i.t=this.t-e,i.clamp()}},i.prototype.subTo=function(t,i){for(var e=0,r=0,n=Math.min(t.t,this.t);e<n;)r+=this[e]-t[e],i[e++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;e<this.t;)r+=this[e],i[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r-=t[e],i[e++]=r&this.DM,r>>=this.DB;r-=t.s}i.s=r<0?-1:0,r<-1?i[e++]=this.DV+r:r>0&&(i[e++]=r),i.t=e,i.clamp()},i.prototype.multiplyTo=function(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e[o]=0;for(o=0;o<n.t;++o)e[o+r.t]=r.am(0,n[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&i.ZERO.subTo(e,e)},i.prototype.squareTo=function(t){for(var i=this.abs(),e=t.t=2*i.t;--e>=0;)t[e]=0;for(e=0;e<i.t-1;++e){var r=i.am(e,i[e],t,2*e,0,1);(t[e+i.t]+=i.am(e+1,2*i[e],t,2*e+1,r,i.t-e-1))>=i.DV&&(t[e+i.t]-=i.DV,t[e+i.t+1]=1)}t.t>0&&(t[t.t-1]+=i.am(e,i[e],t,2*e,0,1)),t.s=0,t.clamp()},i.prototype.divRemTo=function(t,r,n){var o=t.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=r&&r.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=e());var u=e(),h=this.s,a=t.s,f=this.DB-p(o[o.t-1]);f>0?(o.lShiftTo(f,u),s.lShiftTo(f,n)):(o.copyTo(u),s.copyTo(n));var c=u.t,l=u[c-1];if(0!=l){var g=l*(1<<this.F1)+(c>1?u[c-2]>>this.F2:0),y=this.FV/g,m=(1<<this.F1)/g,d=1<<this.F2,v=n.t,B=v-c,T=null==r?e():r;for(u.dlShiftTo(B,T),n.compareTo(T)>=0&&(n[n.t++]=1,n.subTo(T,n)),i.ONE.dlShiftTo(c,T),T.subTo(u,u);u.t<c;)u[u.t++]=0;for(;--B>=0;){var F=n[--v]==l?this.DM:Math.floor(n[v]*y+(n[v-1]+d)*m);if((n[v]+=u.am(0,F,n,B,0,c))<F)for(u.dlShiftTo(B,T),n.subTo(T,n);n[v]<--F;)n.subTo(T,n)}null!=r&&(n.drShiftTo(c,r),h!=a&&i.ZERO.subTo(r,r)),n.t=c,n.clamp(),f>0&&n.rShiftTo(f,n),h<0&&i.ZERO.subTo(n,n)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.DV)%this.DV)>0?this.DV-i:-i},i.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},i.prototype.exp=function(t,r){if(t>4294967295||t<1)return i.ONE;var n=e(),o=e(),s=r.convert(this),u=p(t)-1;for(s.copyTo(n);--u>=0;)if(r.sqrTo(n,o),(t&1<<u)>0)r.mulTo(o,s,n);else{var h=n;n=o,o=h}return r.revert(n)},i.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.toRadix(t);i=2}var e,r=(1<<i)-1,n=!1,o="",s=this.t,h=this.DB-s*this.DB%i;if(s-- >0)for(h<this.DB&&(e=this[s]>>h)>0&&(n=!0,o=u(e));s>=0;)h<i?(e=(this[s]&(1<<h)-1)<<i-h,e|=this[--s]>>(h+=this.DB-i)):(e=this[s]>>(h-=i)&r,h<=0&&(h+=this.DB,--s)),e>0&&(n=!0),n&&(o+=u(e));return n?o:"0"},i.prototype.negate=function(){var t=e();return i.ZERO.subTo(this,t),t},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(t){var i=this.s-t.s;if(0!=i)return i;var e=this.t;if(0!=(i=e-t.t))return i;for(;--e>=0;)if(0!=(i=this[e]-t[e]))return i;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},i.prototype.mod=function(t){var r=e();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(i.ZERO)>0&&t.subTo(r,r),r},i.prototype.modPowInt=function(t,i){var e;return e=t<256||i.isEven()?new B(i):new T(i),this.exp(t,e)},i.ZERO=a(0),i.ONE=a(1);var l=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],g=(1<<26)/l[l.length-1];function y(t,i){return t&i}function m(t,i){return t|i}function d(t,i){return t^i}function v(t,i){return t&~i}function B(t){this.m=t}function T(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function F(){}function b(t){this.r2=e(),this.q3=e(),i.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}i.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},i.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var i=this.chunkSize(t),r=Math.pow(t,i),n=a(r),o=e(),s=e(),u="";for(this.divRemTo(n,o,s);o.signum()>0;)u=(r+s.intValue()).toString(t).substr(1)+u,o.divRemTo(n,o,s);return s.intValue().toString(t)+u},i.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,u=0,a=0;a<t.length;++a){var p=h(t,a);p<0?"-"==t.charAt(a)&&0==this.signum()&&(o=!0):(u=e*u+p,++s>=r&&(this.dMultiply(n),this.dAddOffset(u,0),s=0,u=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(u,0)),o&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(i.ONE.shiftLeft(t-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(i.ONE.shiftLeft(t-1),this);else{var n=new Array,o=7&t;n.length=1+(t>>3),e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}},i.prototype.bitwiseTo=function(t,i,e){var r,n,o=Math.min(t.t,this.t);for(r=0;r<o;++r)e[r]=i(this[r],t[r]);if(t.t<this.t){for(n=t.s&this.DM,r=o;r<this.t;++r)e[r]=i(this[r],n);e.t=this.t}else{for(n=this.s&this.DM,r=o;r<t.t;++r)e[r]=i(n,t[r]);e.t=t.t}e.s=i(this.s,t.s),e.clamp()},i.prototype.changeBit=function(t,e){var r=i.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},i.prototype.addTo=function(t,i){for(var e=0,r=0,n=Math.min(t.t,this.t);e<n;)r+=this[e]+t[e],i[e++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;e<this.t;)r+=this[e],i[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r+=t[e],i[e++]=r&this.DM,r>>=this.DB;r+=t.s}i.s=r<0?-1:0,r>0?i[e++]=r:r<-1&&(i[e++]=this.DV+r),i.t=e,i.clamp()},i.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(t,i){if(0!=t){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=t;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}},i.prototype.multiplyLowerTo=function(t,i,e){var r,n=Math.min(this.t+t.t,i);for(e.s=0,e.t=n;n>0;)e[--n]=0;for(r=e.t-this.t;n<r;++n)e[n+this.t]=this.am(0,t[n],e,n,0,this.t);for(r=Math.min(t.t,i);n<r;++n)this.am(0,t[n],e,n,0,i-n);e.clamp()},i.prototype.multiplyUpperTo=function(t,i,e){--i;var r=e.t=this.t+t.t-i;for(e.s=0;--r>=0;)e[r]=0;for(r=Math.max(i-this.t,0);r<t.t;++r)e[this.t+r-i]=this.am(i-r,t[r],e,0,0,this.t+r-i);e.clamp(),e.drShiftTo(1,e)},i.prototype.modInt=function(t){if(t<=0)return 0;var i=this.DV%t,e=this.s<0?t-1:0;if(this.t>0)if(0==i)e=this[0]%t;else for(var r=this.t-1;r>=0;--r)e=(i*e+this[r])%t;return e},i.prototype.millerRabin=function(t){var r=this.subtract(i.ONE),n=r.getLowestSetBit();if(n<=0)return!1;var o=r.shiftRight(n);(t=t+1>>1)>l.length&&(t=l.length);for(var s=e(),u=0;u<t;++u){s.fromInt(l[Math.floor(Math.random()*l.length)]);var h=s.modPow(o,this);if(0!=h.compareTo(i.ONE)&&0!=h.compareTo(r)){for(var a=1;a++<n&&0!=h.compareTo(r);)if(0==(h=h.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=h.compareTo(r))return!1}}return!0},i.prototype.clone=function(){var t=e();return this.copyTo(t),t},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},i.prototype.toByteArray=function(){var t=this.t,i=new Array;i[0]=this.s;var e,r=this.DB-t*this.DB%8,n=0;if(t-- >0)for(r<this.DB&&(e=this[t]>>r)!=(this.s&this.DM)>>r&&(i[n++]=e|this.s<<this.DB-r);t>=0;)r<8?(e=(this[t]&(1<<r)-1)<<8-r,e|=this[--t]>>(r+=this.DB-8)):(e=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==n&&(128&this.s)!=(128&e)&&++n,(n>0||e!=this.s)&&(i[n++]=e);return i},i.prototype.equals=function(t){return 0==this.compareTo(t)},i.prototype.min=function(t){return this.compareTo(t)<0?this:t},i.prototype.max=function(t){return this.compareTo(t)>0?this:t},i.prototype.and=function(t){var i=e();return this.bitwiseTo(t,y,i),i},i.prototype.or=function(t){var i=e();return this.bitwiseTo(t,m,i),i},i.prototype.xor=function(t){var i=e();return this.bitwiseTo(t,d,i),i},i.prototype.andNot=function(t){var i=e();return this.bitwiseTo(t,v,i),i},i.prototype.not=function(){for(var t=e(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];return t.t=this.t,t.s=~this.s,t},i.prototype.shiftLeft=function(t){var i=e();return t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i),i},i.prototype.shiftRight=function(t){var i=e();return t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i),i},i.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+f(this[t]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var t=0,i=this.s&this.DM,e=0;e<this.t;++e)t+=c(this[e]^i);return t},i.prototype.testBit=function(t){var i=Math.floor(t/this.DB);return i>=this.t?0!=this.s:0!=(this[i]&1<<t%this.DB)},i.prototype.setBit=function(t){return this.changeBit(t,m)},i.prototype.clearBit=function(t){return this.changeBit(t,v)},i.prototype.flipBit=function(t){return this.changeBit(t,d)},i.prototype.add=function(t){var i=e();return this.addTo(t,i),i},i.prototype.subtract=function(t){var i=e();return this.subTo(t,i),i},i.prototype.multiply=function(t){var i=e();return this.multiplyTo(t,i),i},i.prototype.divide=function(t){var i=e();return this.divRemTo(t,i,null),i},i.prototype.remainder=function(t){var i=e();return this.divRemTo(t,null,i),i},i.prototype.divideAndRemainder=function(t){var i=e(),r=e();return this.divRemTo(t,i,r),new Array(i,r)},i.prototype.modPow=function(t,i){var r,n,o=t.bitLength(),s=a(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,n=o<8?new B(i):i.isEven()?new b(i):new T(i);var u=new Array,h=3,f=r-1,c=(1<<r)-1;if(u[1]=n.convert(this),r>1){var l=e();for(n.sqrTo(u[1],l);h<=c;)u[h]=e(),n.mulTo(l,u[h-2],u[h]),h+=2}var g,y,m=t.t-1,d=!0,v=e();for(o=p(t[m])-1;m>=0;){for(o>=f?g=t[m]>>o-f&c:(g=(t[m]&(1<<o+1)-1)<<f-o,m>0&&(g|=t[m-1]>>this.DB+o-f)),h=r;0==(1&g);)g>>=1,--h;if((o-=h)<0&&(o+=this.DB,--m),d)u[g].copyTo(s),d=!1;else{for(;h>1;)n.sqrTo(s,v),n.sqrTo(v,s),h-=2;h>0?n.sqrTo(s,v):(y=s,s=v,v=y),n.mulTo(v,u[g],s)}for(;m>=0&&0==(t[m]&1<<o);)n.sqrTo(s,v),y=s,s=v,v=y,--o<0&&(o=this.DB-1,--m)}return n.revert(s)},i.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return i.ZERO;for(var r=t.clone(),n=this.clone(),o=a(1),s=a(0),u=a(0),h=a(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?(u.isEven()&&h.isEven()||(u.addTo(this,u),h.subTo(t,h)),u.rShiftTo(1,u)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(u,o),s.subTo(h,s)):(n.subTo(r,n),e&&u.subTo(o,u),h.subTo(s,h))}return 0!=n.compareTo(i.ONE)?i.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h},i.prototype.pow=function(t){return this.exp(t,new F)},i.prototype.gcd=function(t){var i=this.s<0?this.negate():this.clone(),e=t.s<0?t.negate():t.clone();if(i.compareTo(e)<0){var r=i;i=e,e=r}var n=i.getLowestSetBit(),o=e.getLowestSetBit();if(o<0)return i;for(n<o&&(o=n),o>0&&(i.rShiftTo(o,i),e.rShiftTo(o,e));i.signum()>0;)(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),i.compareTo(e)>=0?(i.subTo(e,i),i.rShiftTo(1,i)):(e.subTo(i,e),e.rShiftTo(1,e));return o>0&&e.lShiftTo(o,e),e},i.prototype.isProbablePrime=function(t){var i,e=this.abs();if(1==e.t&&e[0]<=l[l.length-1]){for(i=0;i<l.length;++i)if(e[0]==l[i])return!0;return!1}if(e.isEven())return!1;for(i=1;i<l.length;){for(var r=l[i],n=i+1;n<l.length&&r<g;)r*=l[n++];for(r=e.modInt(r);i<n;)if(r%l[i++]==0)return!1}return e.millerRabin(t)},i.prototype.square=function(){var t=e();return this.squareTo(t),t},i.valueOf=a,i.prototype.toByteArrayUnsigned=function(){var t=this.toByteArray();return t.length?(0==t[0]&&(t=t.slice(1)),t.map(function(t){return t<0?t+256:t})):t},i.fromByteArrayUnsigned=function(t){return t.length?128&t[0]?new i([0].concat(t)):new i(t):t.valueOf(0)},B.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},B.prototype.revert=function(t){return t},B.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},B.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},B.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},T.prototype.convert=function(t){var r=e();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(i.ZERO)>0&&this.m.subTo(r,r),r},T.prototype.revert=function(t){var i=e();return t.copyTo(i),this.reduce(i),i},T.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var e=32767&t[i],r=e*this.mpl+((e*this.mph+(t[i]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[e=i+this.m.t]+=this.m.am(0,r,t,i,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},T.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},T.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},F.prototype.convert=function(t){return t},F.prototype.revert=function(t){return t},F.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e)},F.prototype.sqrTo=function(t,i){t.squareTo(i)},b.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=e();return t.copyTo(i),this.reduce(i),i},b.prototype.revert=function(t){return t},b.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},b.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},b.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)}}(),
function(){var t=window.SecureRandom=function(){};if(t.state,t.pool,t.pptr,t.poolSize=256,t.prototype.nextBytes=function(i){var e;for(e=0;e<i.length;++e)i[e]=t.getByte()},t.seedTime=function(){t.seedInt((new Date).getTime())},t.getByte=function(){if(null==t.state){for(t.seedTime(),t.state=t.ArcFour(),t.state.init(t.pool),t.pptr=0;t.pptr<t.pool.length;++t.pptr)t.pool[t.pptr]=0;t.pptr=0}return t.state.next()},t.seedInt=function(i){t.pool[t.pptr++]^=255&i,t.pool[t.pptr++]^=i>>8&255,t.pool[t.pptr++]^=i>>16&255,t.pool[t.pptr++]^=i>>24&255,t.pptr>=t.poolSize&&(t.pptr-=t.poolSize)},t.ArcFour=function(){function t(){this.i=0,this.j=0,this.S=new Array}return t.prototype.init=function(t){var i,e,r;for(i=0;i<256;++i)this.S[i]=i;for(e=0,i=0;i<256;++i)e=e+this.S[i]+t[i%t.length]&255,r=this.S[i],this.S[i]=this.S[e],this.S[e]=r;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},new t},null==t.pool){var i;if(t.pool=new Array,t.pptr=0,"Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var e=window.crypto.random(32);for(i=0;i<e.length;++i)t.pool[t.pptr++]=255&e.charCodeAt(i)}for(;t.pptr<t.poolSize;)i=Math.floor(65536*Math.random()),t.pool[t.pptr++]=i>>>8,t.pool[t.pptr++]=255&i;t.pptr=0,t.seedTime(),t.seedInt(window.screenX),t.seedInt(window.screenY)}}(),window.Bitcoin=function(){var t,i,e,r,n={};return t=n.Base58={alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",base:BigInteger.valueOf(58),encode:function(i){for(var e=BigInteger.fromByteArrayUnsigned(i),r=[];e.compareTo(t.base)>=0;){var n=e.mod(t.base);r.unshift(t.alphabet[n.intValue()]),e=e.subtract(n).divide(t.base)}r.unshift(t.alphabet[e.intValue()]);for(var o=0;o<i.length&&0==i[o];o++)r.unshift(t.alphabet[0]);return s=r.join(""),s},decode:function(i){bi=BigInteger.valueOf(0);for(var e=0,r=i.length-1;r>=0;r--){var n=t.alphabet.indexOf(i[r]);bi=bi.add(BigInteger.valueOf(n).multiply(t.base.pow(i.length-1-r))),"1"==i[r]?e++:e=0}for(var o=bi.toByteArrayUnsigned();e-- >0;)o.unshift(0);return o}},n.Address=function(t){"string"==typeof t&&(t=n.Address.decodeString(t)),this.hash=t,this.version=n.Address.networkVersion},n.Address.networkVersion=0,n.Address.prototype.toString=function(){var t=this.hash.slice(0);t.unshift(this.version);var i=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0}),e=t.concat(i.slice(0,4));return n.Base58.encode(e)},n.Address.prototype.getHashBase64=function(){return Crypto.util.bytesToBase64(this.hash)},n.Address.decodeString=function(t){var i=n.Base58.decode(t),e=i.slice(0,21),r=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0});if(r[0]!=i[21]||r[1]!=i[22]||r[2]!=i[23]||r[3]!=i[24])throw"Checksum validation failed!";var o=e.shift();if(0!=o)throw"Version "+o+" not supported!";return e},n.ECDSA=function(){var t=EllipticCurve.getSECCurveByName("secp256k1"),i=new SecureRandom;var e={getBigRandom:function(t){return new BigInteger(t.bitLength(),i).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},sign:function(i,r){var n=r,o=t.getN(),s=BigInteger.fromByteArrayUnsigned(i);do{var u=e.getBigRandom(o),h=t.getG().multiply(u).getX().toBigInteger().mod(o)}while(h.compareTo(BigInteger.ZERO)<=0);var a=u.modInverse(o).multiply(s.add(n.multiply(h))).mod(o);return e.serializeSig(h,a)},serializeSig:function(t,i){var e=t.toByteArrayUnsigned(),r=i.toByteArrayUnsigned(),n=[];return n.push(2),n.push(e.length),(n=n.concat(e)).push(2),n.push(r.length),(n=n.concat(r)).unshift(n.length),n.unshift(48),n},verify:function(i,r,n){var o=e.parseSig(r),s=o.r,u=o.s,h=t.getN(),a=BigInteger.fromByteArrayUnsigned(i);if(s.compareTo(BigInteger.ONE)<0||s.compareTo(h)>=0)return!1;if(u.compareTo(BigInteger.ONE)<0||u.compareTo(h)>=0)return!1;var p=u.modInverse(h),f=a.multiply(p).mod(h),c=s.multiply(p).mod(h);return function(t,i,e,r){for(var n=Math.max(i.bitLength(),r.bitLength()),o=t.add2D(e),s=t.curve.getInfinity(),u=n-1;u>=0;--u)(s=s.twice2D()).z=BigInteger.ONE,i.testBit(u)?s=r.testBit(u)?s.add2D(o):s.add2D(t):r.testBit(u)&&(s=s.add2D(e));return s}(t.getG(),f,ECPointFp.decodeFrom(t.getCurve(),n),c).x.toBigInteger().mod(h).equals(s)},parseSig:function(t){var i;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[i=2])throw new Error("First element in signature must be a DERInteger");var e=t.slice(i+2,i+2+t[i+1]);if(2!=t[i+=2+t[i+1]])throw new Error("Second element in signature must be a DERInteger");var r=t.slice(i+2,i+2+t[i+1]);return i+=2+t[i+1],{r:BigInteger.fromByteArrayUnsigned(e),s:BigInteger.fromByteArrayUnsigned(r)}}};return e}(),n.ECKey=(i=n.ECDSA,e=EllipticCurve.getSECCurveByName("secp256k1"),new SecureRandom,(r=function(t){if(t)t instanceof BigInteger?this.priv=t:n.Util.isArray(t)?this.priv=BigInteger.fromByteArrayUnsigned(t):"string"==typeof t&&(this.priv=BigInteger.fromByteArrayUnsigned(Crypto.util.base64ToBytes(t)));else{var r=e.getN();this.priv=i.getBigRandom(r)}}).prototype.getPub=function(){return this.pub?this.pub:this.pub=e.getG().multiply(this.priv).getEncoded(0)},r.prototype.getPubCompressed=function(){return this.pubCompressed?this.pubCompressed:this.pubCompressed=e.getG().multiply(this.priv).getEncoded(1)},r.prototype.getPubKeyHash=function(){return this.pubKeyHash?this.pubKeyHash:this.pubKeyHash=n.Util.sha256ripe160(this.getPub())},r.prototype.getPubKeyHashCompressed=function(){return this.pubKeyHashCompressed?this.pubKeyHashCompressed:this.pubKeyHashCompressed=n.Util.sha256ripe160(this.getPubCompressed())},r.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash();return new n.Address(t).toString()},r.prototype.getBitcoinAddressCompressed=function(){var t=this.getPubKeyHashCompressed();return new n.Address(t).toString()},r.prototype.getBitcoinWalletImportFormat=function(){var t=this.getBitcoinPrivateKeyByteArray();t.unshift(128);var i=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0});return t=t.concat(i.slice(0,4)),n.Base58.encode(t)},r.prototype.getBitcoinWalletImportFormatCompressed=function(){var t=this.getBitcoinPrivateKeyByteArray();t.unshift(128),t.push(1);var i=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0});return t=t.concat(i.slice(0,4)),n.Base58.encode(t)},r.prototype.getBitcoinHexFormat=function(){return Crypto.util.bytesToHex(this.getBitcoinPrivateKeyByteArray()).toString().toUpperCase()},r.prototype.getBitcoinBase64Format=function(){return Crypto.util.bytesToBase64(this.getBitcoinPrivateKeyByteArray())},r.prototype.getBitcoinPrivateKeyByteArray=function(){for(var t=this.priv.toByteArrayUnsigned();t.length<32;)t.unshift(0);return t},r.prototype.setPub=function(t){this.pub=t},r.prototype.setPubCompressed=function(t){this.pubCompressed=t},r.prototype.toString=function(t){return"base64"==(t=t||"").toString().toLowerCase()||"b64"==t.toString().toLowerCase()?this.getBitcoinBase64Format():"wif"==t.toString().toLowerCase()?this.getBitcoinWalletImportFormat():"wifcomp"==t.toString().toLowerCase()?this.getBitcoinWalletImportFormatCompressed():this.getBitcoinHexFormat()},r.prototype.sign=function(t){return i.sign(t,this.priv)},r.prototype.verify=function(t,e){return i.verify(t,e,this.getPub())},r),n.Util={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},makeFilledArray:function(t,i){for(var e=[],r=0;r<t;)e[r++]=i;return e},numToVarInt:function(t){return t<253?[t]:t<=65536?[253,t>>>8,255&t]:t<=1?[254].concat(Crypto.util.wordsToBytes([t])):[255].concat(Crypto.util.wordsToBytes([t>>>32,t]))},valueToBigInt:function(t){return t instanceof BigInteger?t:BigInteger.fromByteArrayUnsigned(t)},formatValue:function(t){for(var i=this.valueToBigInt(t).toString(),e=i.length>8?i.substr(0,i.length-8):"0",r=i.length>8?i.substr(i.length-8):i;r.length<8;)r="0"+r;for(r=r.replace(/0*$/,"");r.length<2;)r+="0";return e+"."+r},parseValue:function(t){for(var i=t.split("."),e=i[0],r=i[1]||"0";r.length<8;)r+="0";r=r.replace(/^0+/g,"");var n=BigInteger.valueOf(parseInt(e));return n=(n=n.multiply(BigInteger.valueOf(1e8))).add(BigInteger.valueOf(parseInt(r)))},sha256ripe160:function(t){return Crypto.RIPEMD160(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})}},n}(),document&&document.body){var sdupd=function(){SecureRandom.seedTime()},ctime=(new Date).getTime(),sdclk=function(t){sdupd();var i=parseInt(ctime*t.clientX/t.clientY);SecureRandom.seedInt(i),console.log(i)};document.body.onclick=sdclk,document.body.onkeydown=sdupd,document.body.onmousemove=sdclk}
